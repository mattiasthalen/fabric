-- Auto Generated (Do not modify) FFAFF4F772CF70C142225C306B9DE4C5DA12CFA85AC5D402F69EEE082B85A47D
CREATE   VIEW [sqlmesh__uss__staging].[uss__staging___bridge__products__1155860947] ([peripheral], [_pit_hook__product__id], [_pit_hook__category__id], [_pit_hook__category_detail__id], [_record__updated_at], [_record__valid_from], [_record__valid_to], [_record__is_current]) AS WITH [cte__bridge] AS (SELECT 'products' AS [peripheral], [frame__northwind__products].[_pit_hook__product__id] AS [_pit_hook__product__id], [frame__northwind__categories].[_pit_hook__category__id] AS [_pit_hook__category__id], [frame__northwind__category_details].[_pit_hook__category__id] AS [_pit_hook__category_detail__id], GREATEST([frame__northwind__products].[_record__updated_at], [frame__northwind__categories].[_record__updated_at], [frame__northwind__category_details].[_record__updated_at]) AS [_record__updated_at], GREATEST([frame__northwind__products].[_record__valid_from], [frame__northwind__categories].[_record__valid_from], [frame__northwind__category_details].[_record__valid_from]) AS [_record__valid_from], LEAST([frame__northwind__products].[_record__valid_to], [frame__northwind__categories].[_record__valid_to], [frame__northwind__category_details].[_record__valid_to]) AS [_record__valid_to], LEAST([frame__northwind__products].[_record__is_current], [frame__northwind__categories].[_record__is_current], [frame__northwind__category_details].[_record__is_current]) AS [_record__is_current] FROM [dab].[sqlmesh__hook].[hook__frame__northwind__products__813427804] AS [frame__northwind__products] LEFT JOIN [dab].[sqlmesh__hook].[hook__frame__northwind__categories__1452147882] AS [frame__northwind__categories] ON [frame__northwind__categories].[_hook__category__id] = [frame__northwind__products].[_hook__category__id] LEFT JOIN [dab].[sqlmesh__hook].[hook__frame__northwind__category_details__1487641637] AS [frame__northwind__category_details] ON [frame__northwind__category_details].[_hook__category__id] = [frame__northwind__products].[_hook__category__id] WHERE [frame__northwind__categories].[_record__valid_from] >= [frame__northwind__products].[_record__valid_to] AND [frame__northwind__categories].[_record__valid_to] <= [frame__northwind__products].[_record__valid_from] AND [frame__northwind__category_details].[_record__valid_from] >= [frame__northwind__products].[_record__valid_to] AND [frame__northwind__category_details].[_record__valid_to] <= [frame__northwind__products].[_record__valid_from]) SELECT [cte__bridge].[peripheral] AS [peripheral], [cte__bridge].[_pit_hook__product__id] AS [_pit_hook__product__id], [cte__bridge].[_pit_hook__category__id] AS [_pit_hook__category__id], [cte__bridge].[_pit_hook__category_detail__id] AS [_pit_hook__category_detail__id], [cte__bridge].[_record__updated_at] AS [_record__updated_at], [cte__bridge].[_record__valid_from] AS [_record__valid_from], [cte__bridge].[_record__valid_to] AS [_record__valid_to], [cte__bridge].[_record__is_current] AS [_record__is_current] FROM [cte__bridge] AS [cte__bridge];