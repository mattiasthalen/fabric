-- Auto Generated (Do not modify) 6F2F69A1BC97C3A22E966662047B7481C4BD7D076164907511913D8E8F68912D
CREATE   VIEW [sqlmesh__scd].[scd__scd_view__northwind__products__1887842046] ([product_id], [product_name], [supplier_id], [category_id], [quantity_per_unit], [unit_price], [units_in_stock], [units_on_order], [reorder_level], [discontinued], [_dlt_load_id], [_dlt_id], [_record__hash], [_record__loaded_at], [_record__updated_at], [_record__valid_from], [_record__valid_to], [_record__is_current], [_record__version]) AS SELECT [scd__northwind__products].[product_id] AS [product_id], [scd__northwind__products].[product_name] AS [product_name], [scd__northwind__products].[supplier_id] AS [supplier_id], [scd__northwind__products].[category_id] AS [category_id], [scd__northwind__products].[quantity_per_unit] AS [quantity_per_unit], [scd__northwind__products].[unit_price] AS [unit_price], [scd__northwind__products].[units_in_stock] AS [units_in_stock], [scd__northwind__products].[units_on_order] AS [units_on_order], [scd__northwind__products].[reorder_level] AS [reorder_level], [scd__northwind__products].[discontinued] AS [discontinued], [scd__northwind__products].[_dlt_load_id] AS [_dlt_load_id], [scd__northwind__products].[_dlt_id] AS [_dlt_id], [scd__northwind__products].[_record__hash] AS [_record__hash], [scd__northwind__products].[_record__loaded_at] AS [_record__loaded_at], GREATEST([scd__northwind__products].[_record__valid_to], [scd__northwind__products].[_record__loaded_at]) AS [_record__updated_at], [scd__northwind__products].[_record__valid_from] AS [_record__valid_from], COALESCE([scd__northwind__products].[_record__valid_to], CAST('9999-12-31 23:59:59' AS DATETIME2(6))) AS [_record__valid_to], CASE WHEN [scd__northwind__products].[_record__valid_to] IS NULL THEN 1 ELSE 0 END AS [_record__is_current], ROW_NUMBER() OVER (PARTITION BY [scd__northwind__products].[product_id] ORDER BY CASE WHEN [scd__northwind__products].[_record__valid_from] IS NULL THEN 1 ELSE 0 END, [scd__northwind__products].[_record__valid_from] ASC) AS [_record__version] FROM [das].[sqlmesh__scd].[scd__scd__northwind__products__3464355507] AS [scd__northwind__products];