-- Auto Generated (Do not modify) 3F704EAFEC51F41C482817E52944DE5C8333D8ADBA59C6CD972F167CD0103F01
CREATE   VIEW [sqlmesh__scd].[scd__scd_view__northwind__orders__3921507700] ([order_id], [customer_id], [employee_id], [order_date], [required_date], [shipped_date], [ship_via], [freight], [ship_name], [ship_address], [ship_city], [ship_postal_code], [ship_country], [_dlt_load_id], [_dlt_id], [ship_region], [_record__hash], [_record__loaded_at], [_record__updated_at], [_record__valid_from], [_record__valid_to], [_record__is_current], [_record__version]) AS SELECT [scd__northwind__orders].[order_id] AS [order_id], [scd__northwind__orders].[customer_id] AS [customer_id], [scd__northwind__orders].[employee_id] AS [employee_id], [scd__northwind__orders].[order_date] AS [order_date], [scd__northwind__orders].[required_date] AS [required_date], [scd__northwind__orders].[shipped_date] AS [shipped_date], [scd__northwind__orders].[ship_via] AS [ship_via], [scd__northwind__orders].[freight] AS [freight], [scd__northwind__orders].[ship_name] AS [ship_name], [scd__northwind__orders].[ship_address] AS [ship_address], [scd__northwind__orders].[ship_city] AS [ship_city], [scd__northwind__orders].[ship_postal_code] AS [ship_postal_code], [scd__northwind__orders].[ship_country] AS [ship_country], [scd__northwind__orders].[_dlt_load_id] AS [_dlt_load_id], [scd__northwind__orders].[_dlt_id] AS [_dlt_id], [scd__northwind__orders].[ship_region] AS [ship_region], [scd__northwind__orders].[_record__hash] AS [_record__hash], [scd__northwind__orders].[_record__loaded_at] AS [_record__loaded_at], GREATEST([scd__northwind__orders].[_record__valid_to], [scd__northwind__orders].[_record__loaded_at]) AS [_record__updated_at], [scd__northwind__orders].[_record__valid_from] AS [_record__valid_from], COALESCE([scd__northwind__orders].[_record__valid_to], CAST('9999-12-31 23:59:59' AS DATETIME2(6))) AS [_record__valid_to], CASE WHEN [scd__northwind__orders].[_record__valid_to] IS NULL THEN 1 ELSE 0 END AS [_record__is_current], ROW_NUMBER() OVER (PARTITION BY [scd__northwind__orders].[order_id] ORDER BY CASE WHEN [scd__northwind__orders].[_record__valid_from] IS NULL THEN 1 ELSE 0 END, [scd__northwind__orders].[_record__valid_from] ASC) AS [_record__version] FROM [das].[sqlmesh__scd].[scd__scd__northwind__orders__4112261102] AS [scd__northwind__orders];