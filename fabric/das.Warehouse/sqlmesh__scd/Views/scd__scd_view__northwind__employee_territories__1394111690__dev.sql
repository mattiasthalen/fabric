-- Auto Generated (Do not modify) 17FB1E69C7BA3472AC0A81F6003FE3F57A3FDE555DBEDE4C177DC166BE9FAE96
CREATE   VIEW [sqlmesh__scd].[scd__scd_view__northwind__employee_territories__1394111690__dev] ([territory_id], [territory_description], [region_id], [_get_northwindapiv_1_employees_employee_id], [_dlt_load_id], [_dlt_id], [_record__hash], [_record__loaded_at], [_record__updated_at], [_record__valid_from], [_record__valid_to], [_record__is_current], [_record__version]) AS SELECT [scd__northwind__employee_territories].[territory_id] AS [territory_id], [scd__northwind__employee_territories].[territory_description] AS [territory_description], [scd__northwind__employee_territories].[region_id] AS [region_id], [scd__northwind__employee_territories].[_get_northwindapiv_1_employees_employee_id] AS [_get_northwindapiv_1_employees_employee_id], [scd__northwind__employee_territories].[_dlt_load_id] AS [_dlt_load_id], [scd__northwind__employee_territories].[_dlt_id] AS [_dlt_id], [scd__northwind__employee_territories].[_record__hash] AS [_record__hash], [scd__northwind__employee_territories].[_record__loaded_at] AS [_record__loaded_at], GREATEST([scd__northwind__employee_territories].[_record__valid_to], [scd__northwind__employee_territories].[_record__loaded_at]) AS [_record__updated_at], [scd__northwind__employee_territories].[_record__valid_from] AS [_record__valid_from], COALESCE([scd__northwind__employee_territories].[_record__valid_to], CAST('9999-12-31 23:59:59' AS DATETIME2(6))) AS [_record__valid_to], CASE WHEN [scd__northwind__employee_territories].[_record__valid_to] IS NULL THEN 1 ELSE 0 END AS [_record__is_current], ROW_NUMBER() OVER (PARTITION BY CAST([scd__northwind__employee_territories].[_get_northwindapiv_1_employees_employee_id] AS VARCHAR(MAX)) + '|' + CAST([scd__northwind__employee_territories].[territory_id] AS VARCHAR(MAX)) ORDER BY CASE WHEN [scd__northwind__employee_territories].[_record__valid_from] IS NULL THEN 1 ELSE 0 END, [scd__northwind__employee_territories].[_record__valid_from] ASC) AS [_record__version] FROM [das].[sqlmesh__scd].[scd__scd__northwind__employee_territories__1683401676__dev] AS [scd__northwind__employee_territories];