-- Auto Generated (Do not modify) AE60259A781FECF32A471D53A3EEE9168E71EF78CE0B8A9C20768B44EDD0A0CB
CREATE   VIEW [sqlmesh__hook].[hook__frame__northwind__suppliers__3455306392] ([_pit_hook__supplier__id], [hook__supplier__id], [hook__supplier__name], [supplier_id], [company_name], [contact_name], [contact_title], [address], [city], [postal_code], [country], [phone], [_dlt_load_id], [_dlt_id], [region], [home_page], [fax], [_record__hash], [_record__loaded_at], [_record__updated_at], [_record__valid_from], [_record__valid_to], [_record__version], [_record__is_current]) AS WITH [cte__source] AS (SELECT [scd__northwind__suppliers].[supplier_id] AS [supplier_id], [scd__northwind__suppliers].[company_name] AS [company_name], [scd__northwind__suppliers].[contact_name] AS [contact_name], [scd__northwind__suppliers].[contact_title] AS [contact_title], [scd__northwind__suppliers].[address] AS [address], [scd__northwind__suppliers].[city] AS [city], [scd__northwind__suppliers].[postal_code] AS [postal_code], [scd__northwind__suppliers].[country] AS [country], [scd__northwind__suppliers].[phone] AS [phone], [scd__northwind__suppliers].[_dlt_load_id] AS [_dlt_load_id], [scd__northwind__suppliers].[_dlt_id] AS [_dlt_id], [scd__northwind__suppliers].[region] AS [region], [scd__northwind__suppliers].[home_page] AS [home_page], [scd__northwind__suppliers].[fax] AS [fax], [scd__northwind__suppliers].[_record__hash] AS [_record__hash], [scd__northwind__suppliers].[_record__loaded_at] AS [_record__loaded_at], [scd__northwind__suppliers].[_record__updated_at] AS [_record__updated_at], [scd__northwind__suppliers].[_record__valid_from] AS [_record__valid_from], [scd__northwind__suppliers].[_record__valid_to] AS [_record__valid_to], [scd__northwind__suppliers].[_record__version] AS [_record__version], [scd__northwind__suppliers].[_record__is_current] AS [_record__is_current] FROM [das].[sqlmesh__scd].[scd__scd__northwind__suppliers__3930494492] AS [scd__northwind__suppliers]), [cte__hooks] AS (SELECT CONCAT('northwind.supplier.id|', CAST([cte__source].[supplier_id] AS VARCHAR(MAX))) AS [hook__supplier__id], CONCAT('northwind.supplier.name|', CAST([cte__source].[company_name] AS VARCHAR(MAX))) AS [hook__supplier__name], [cte__source].[supplier_id] AS [supplier_id], [cte__source].[company_name] AS [company_name], [cte__source].[contact_name] AS [contact_name], [cte__source].[contact_title] AS [contact_title], [cte__source].[address] AS [address], [cte__source].[city] AS [city], [cte__source].[postal_code] AS [postal_code], [cte__source].[country] AS [country], [cte__source].[phone] AS [phone], [cte__source].[_dlt_load_id] AS [_dlt_load_id], [cte__source].[_dlt_id] AS [_dlt_id], [cte__source].[region] AS [region], [cte__source].[home_page] AS [home_page], [cte__source].[fax] AS [fax], [cte__source].[_record__hash] AS [_record__hash], [cte__source].[_record__loaded_at] AS [_record__loaded_at], [cte__source].[_record__updated_at] AS [_record__updated_at], [cte__source].[_record__valid_from] AS [_record__valid_from], [cte__source].[_record__valid_to] AS [_record__valid_to], [cte__source].[_record__version] AS [_record__version], [cte__source].[_record__is_current] AS [_record__is_current] FROM [cte__source] AS [cte__source]), [cte__composite_hooks] AS (SELECT [cte__hooks].[hook__supplier__id] AS [hook__supplier__id], [cte__hooks].[hook__supplier__name] AS [hook__supplier__name], [cte__hooks].[supplier_id] AS [supplier_id], [cte__hooks].[company_name] AS [company_name], [cte__hooks].[contact_name] AS [contact_name], [cte__hooks].[contact_title] AS [contact_title], [cte__hooks].[address] AS [address], [cte__hooks].[city] AS [city], [cte__hooks].[postal_code] AS [postal_code], [cte__hooks].[country] AS [country], [cte__hooks].[phone] AS [phone], [cte__hooks].[_dlt_load_id] AS [_dlt_load_id], [cte__hooks].[_dlt_id] AS [_dlt_id], [cte__hooks].[region] AS [region], [cte__hooks].[home_page] AS [home_page], [cte__hooks].[fax] AS [fax], [cte__hooks].[_record__hash] AS [_record__hash], [cte__hooks].[_record__loaded_at] AS [_record__loaded_at], [cte__hooks].[_record__updated_at] AS [_record__updated_at], [cte__hooks].[_record__valid_from] AS [_record__valid_from], [cte__hooks].[_record__valid_to] AS [_record__valid_to], [cte__hooks].[_record__version] AS [_record__version], [cte__hooks].[_record__is_current] AS [_record__is_current] FROM [cte__hooks] AS [cte__hooks]), [cte__primary_hooks] AS (SELECT CONCAT([cte__composite_hooks].[hook__supplier__id], '~epoch__valid_from|', CAST([cte__composite_hooks].[_record__valid_from] AS VARCHAR(MAX))) AS [_pit_hook__supplier__id], [cte__composite_hooks].[hook__supplier__id] AS [hook__supplier__id], [cte__composite_hooks].[hook__supplier__name] AS [hook__supplier__name], [cte__composite_hooks].[supplier_id] AS [supplier_id], [cte__composite_hooks].[company_name] AS [company_name], [cte__composite_hooks].[contact_name] AS [contact_name], [cte__composite_hooks].[contact_title] AS [contact_title], [cte__composite_hooks].[address] AS [address], [cte__composite_hooks].[city] AS [city], [cte__composite_hooks].[postal_code] AS [postal_code], [cte__composite_hooks].[country] AS [country], [cte__composite_hooks].[phone] AS [phone], [cte__composite_hooks].[_dlt_load_id] AS [_dlt_load_id], [cte__composite_hooks].[_dlt_id] AS [_dlt_id], [cte__composite_hooks].[region] AS [region], [cte__composite_hooks].[home_page] AS [home_page], [cte__composite_hooks].[fax] AS [fax], [cte__composite_hooks].[_record__hash] AS [_record__hash], [cte__composite_hooks].[_record__loaded_at] AS [_record__loaded_at], [cte__composite_hooks].[_record__updated_at] AS [_record__updated_at], [cte__composite_hooks].[_record__valid_from] AS [_record__valid_from], [cte__composite_hooks].[_record__valid_to] AS [_record__valid_to], [cte__composite_hooks].[_record__version] AS [_record__version], [cte__composite_hooks].[_record__is_current] AS [_record__is_current] FROM [cte__composite_hooks] AS [cte__composite_hooks]) SELECT [cte__primary_hooks].[_pit_hook__supplier__id] AS [_pit_hook__supplier__id], [cte__primary_hooks].[hook__supplier__id] AS [hook__supplier__id], [cte__primary_hooks].[hook__supplier__name] AS [hook__supplier__name], [cte__primary_hooks].[supplier_id] AS [supplier_id], [cte__primary_hooks].[company_name] AS [company_name], [cte__primary_hooks].[contact_name] AS [contact_name], [cte__primary_hooks].[contact_title] AS [contact_title], [cte__primary_hooks].[address] AS [address], [cte__primary_hooks].[city] AS [city], [cte__primary_hooks].[postal_code] AS [postal_code], [cte__primary_hooks].[country] AS [country], [cte__primary_hooks].[phone] AS [phone], [cte__primary_hooks].[_dlt_load_id] AS [_dlt_load_id], [cte__primary_hooks].[_dlt_id] AS [_dlt_id], [cte__primary_hooks].[region] AS [region], [cte__primary_hooks].[home_page] AS [home_page], [cte__primary_hooks].[fax] AS [fax], [cte__primary_hooks].[_record__hash] AS [_record__hash], [cte__primary_hooks].[_record__loaded_at] AS [_record__loaded_at], [cte__primary_hooks].[_record__updated_at] AS [_record__updated_at], [cte__primary_hooks].[_record__valid_from] AS [_record__valid_from], [cte__primary_hooks].[_record__valid_to] AS [_record__valid_to], [cte__primary_hooks].[_record__version] AS [_record__version], [cte__primary_hooks].[_record__is_current] AS [_record__is_current] FROM [cte__primary_hooks] AS [cte__primary_hooks];