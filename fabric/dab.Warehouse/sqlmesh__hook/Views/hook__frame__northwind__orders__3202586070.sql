-- Auto Generated (Do not modify) 3062DCD04B70EE04752F2B50A5B4FA697C7AB6F4D7806C709183312BB79448C8
CREATE   VIEW [sqlmesh__hook].[hook__frame__northwind__orders__3202586070] ([_pit_hook__order__id], [hook__order__id], [hook__customer__id], [hook__employee__id], [hook__shipper__id], [order_id], [customer_id], [employee_id], [order_date], [required_date], [shipped_date], [ship_via], [freight], [ship_name], [ship_address], [ship_city], [ship_postal_code], [ship_country], [_dlt_load_id], [_dlt_id], [ship_region], [_record__hash], [_record__loaded_at], [_record__updated_at], [_record__valid_from], [_record__valid_to], [_record__version], [_record__is_current]) AS WITH [cte__source] AS (SELECT [scd__northwind__orders].[order_id] AS [order_id], [scd__northwind__orders].[customer_id] AS [customer_id], [scd__northwind__orders].[employee_id] AS [employee_id], [scd__northwind__orders].[order_date] AS [order_date], [scd__northwind__orders].[required_date] AS [required_date], [scd__northwind__orders].[shipped_date] AS [shipped_date], [scd__northwind__orders].[ship_via] AS [ship_via], [scd__northwind__orders].[freight] AS [freight], [scd__northwind__orders].[ship_name] AS [ship_name], [scd__northwind__orders].[ship_address] AS [ship_address], [scd__northwind__orders].[ship_city] AS [ship_city], [scd__northwind__orders].[ship_postal_code] AS [ship_postal_code], [scd__northwind__orders].[ship_country] AS [ship_country], [scd__northwind__orders].[_dlt_load_id] AS [_dlt_load_id], [scd__northwind__orders].[_dlt_id] AS [_dlt_id], [scd__northwind__orders].[ship_region] AS [ship_region], [scd__northwind__orders].[_record__hash] AS [_record__hash], [scd__northwind__orders].[_record__loaded_at] AS [_record__loaded_at], [scd__northwind__orders].[_record__updated_at] AS [_record__updated_at], [scd__northwind__orders].[_record__valid_from] AS [_record__valid_from], [scd__northwind__orders].[_record__valid_to] AS [_record__valid_to], [scd__northwind__orders].[_record__version] AS [_record__version], [scd__northwind__orders].[_record__is_current] AS [_record__is_current] FROM [das].[sqlmesh__scd].[scd__scd__northwind__orders__1783281255] AS [scd__northwind__orders]), [cte__hooks] AS (SELECT CONCAT('northwind.order.id|', CAST([cte__source].[order_id] AS VARCHAR(MAX))) AS [hook__order__id], CONCAT('northwind.customer.id|', CAST([cte__source].[customer_id] AS VARCHAR(MAX))) AS [hook__customer__id], CONCAT('northwind.employee.id|', CAST([cte__source].[employee_id] AS VARCHAR(MAX))) AS [hook__employee__id], CONCAT('northwind.shipper.id|', CAST([cte__source].[ship_via] AS VARCHAR(MAX))) AS [hook__shipper__id], [cte__source].[order_id] AS [order_id], [cte__source].[customer_id] AS [customer_id], [cte__source].[employee_id] AS [employee_id], [cte__source].[order_date] AS [order_date], [cte__source].[required_date] AS [required_date], [cte__source].[shipped_date] AS [shipped_date], [cte__source].[ship_via] AS [ship_via], [cte__source].[freight] AS [freight], [cte__source].[ship_name] AS [ship_name], [cte__source].[ship_address] AS [ship_address], [cte__source].[ship_city] AS [ship_city], [cte__source].[ship_postal_code] AS [ship_postal_code], [cte__source].[ship_country] AS [ship_country], [cte__source].[_dlt_load_id] AS [_dlt_load_id], [cte__source].[_dlt_id] AS [_dlt_id], [cte__source].[ship_region] AS [ship_region], [cte__source].[_record__hash] AS [_record__hash], [cte__source].[_record__loaded_at] AS [_record__loaded_at], [cte__source].[_record__updated_at] AS [_record__updated_at], [cte__source].[_record__valid_from] AS [_record__valid_from], [cte__source].[_record__valid_to] AS [_record__valid_to], [cte__source].[_record__version] AS [_record__version], [cte__source].[_record__is_current] AS [_record__is_current] FROM [cte__source] AS [cte__source]), [cte__composite_hooks] AS (SELECT [cte__hooks].[hook__order__id] AS [hook__order__id], [cte__hooks].[hook__customer__id] AS [hook__customer__id], [cte__hooks].[hook__employee__id] AS [hook__employee__id], [cte__hooks].[hook__shipper__id] AS [hook__shipper__id], [cte__hooks].[order_id] AS [order_id], [cte__hooks].[customer_id] AS [customer_id], [cte__hooks].[employee_id] AS [employee_id], [cte__hooks].[order_date] AS [order_date], [cte__hooks].[required_date] AS [required_date], [cte__hooks].[shipped_date] AS [shipped_date], [cte__hooks].[ship_via] AS [ship_via], [cte__hooks].[freight] AS [freight], [cte__hooks].[ship_name] AS [ship_name], [cte__hooks].[ship_address] AS [ship_address], [cte__hooks].[ship_city] AS [ship_city], [cte__hooks].[ship_postal_code] AS [ship_postal_code], [cte__hooks].[ship_country] AS [ship_country], [cte__hooks].[_dlt_load_id] AS [_dlt_load_id], [cte__hooks].[_dlt_id] AS [_dlt_id], [cte__hooks].[ship_region] AS [ship_region], [cte__hooks].[_record__hash] AS [_record__hash], [cte__hooks].[_record__loaded_at] AS [_record__loaded_at], [cte__hooks].[_record__updated_at] AS [_record__updated_at], [cte__hooks].[_record__valid_from] AS [_record__valid_from], [cte__hooks].[_record__valid_to] AS [_record__valid_to], [cte__hooks].[_record__version] AS [_record__version], [cte__hooks].[_record__is_current] AS [_record__is_current] FROM [cte__hooks] AS [cte__hooks]), [cte__primary_hooks] AS (SELECT CONCAT([cte__composite_hooks].[hook__order__id], '~epoch__valid_from|', CAST([cte__composite_hooks].[_record__valid_from] AS VARCHAR(MAX))) AS [_pit_hook__order__id], [cte__composite_hooks].[hook__order__id] AS [hook__order__id], [cte__composite_hooks].[hook__customer__id] AS [hook__customer__id], [cte__composite_hooks].[hook__employee__id] AS [hook__employee__id], [cte__composite_hooks].[hook__shipper__id] AS [hook__shipper__id], [cte__composite_hooks].[order_id] AS [order_id], [cte__composite_hooks].[customer_id] AS [customer_id], [cte__composite_hooks].[employee_id] AS [employee_id], [cte__composite_hooks].[order_date] AS [order_date], [cte__composite_hooks].[required_date] AS [required_date], [cte__composite_hooks].[shipped_date] AS [shipped_date], [cte__composite_hooks].[ship_via] AS [ship_via], [cte__composite_hooks].[freight] AS [freight], [cte__composite_hooks].[ship_name] AS [ship_name], [cte__composite_hooks].[ship_address] AS [ship_address], [cte__composite_hooks].[ship_city] AS [ship_city], [cte__composite_hooks].[ship_postal_code] AS [ship_postal_code], [cte__composite_hooks].[ship_country] AS [ship_country], [cte__composite_hooks].[_dlt_load_id] AS [_dlt_load_id], [cte__composite_hooks].[_dlt_id] AS [_dlt_id], [cte__composite_hooks].[ship_region] AS [ship_region], [cte__composite_hooks].[_record__hash] AS [_record__hash], [cte__composite_hooks].[_record__loaded_at] AS [_record__loaded_at], [cte__composite_hooks].[_record__updated_at] AS [_record__updated_at], [cte__composite_hooks].[_record__valid_from] AS [_record__valid_from], [cte__composite_hooks].[_record__valid_to] AS [_record__valid_to], [cte__composite_hooks].[_record__version] AS [_record__version], [cte__composite_hooks].[_record__is_current] AS [_record__is_current] FROM [cte__composite_hooks] AS [cte__composite_hooks]) SELECT [cte__primary_hooks].[_pit_hook__order__id] AS [_pit_hook__order__id], [cte__primary_hooks].[hook__order__id] AS [hook__order__id], [cte__primary_hooks].[hook__customer__id] AS [hook__customer__id], [cte__primary_hooks].[hook__employee__id] AS [hook__employee__id], [cte__primary_hooks].[hook__shipper__id] AS [hook__shipper__id], [cte__primary_hooks].[order_id] AS [order_id], [cte__primary_hooks].[customer_id] AS [customer_id], [cte__primary_hooks].[employee_id] AS [employee_id], [cte__primary_hooks].[order_date] AS [order_date], [cte__primary_hooks].[required_date] AS [required_date], [cte__primary_hooks].[shipped_date] AS [shipped_date], [cte__primary_hooks].[ship_via] AS [ship_via], [cte__primary_hooks].[freight] AS [freight], [cte__primary_hooks].[ship_name] AS [ship_name], [cte__primary_hooks].[ship_address] AS [ship_address], [cte__primary_hooks].[ship_city] AS [ship_city], [cte__primary_hooks].[ship_postal_code] AS [ship_postal_code], [cte__primary_hooks].[ship_country] AS [ship_country], [cte__primary_hooks].[_dlt_load_id] AS [_dlt_load_id], [cte__primary_hooks].[_dlt_id] AS [_dlt_id], [cte__primary_hooks].[ship_region] AS [ship_region], [cte__primary_hooks].[_record__hash] AS [_record__hash], [cte__primary_hooks].[_record__loaded_at] AS [_record__loaded_at], [cte__primary_hooks].[_record__updated_at] AS [_record__updated_at], [cte__primary_hooks].[_record__valid_from] AS [_record__valid_from], [cte__primary_hooks].[_record__valid_to] AS [_record__valid_to], [cte__primary_hooks].[_record__version] AS [_record__version], [cte__primary_hooks].[_record__is_current] AS [_record__is_current] FROM [cte__primary_hooks] AS [cte__primary_hooks];