-- Auto Generated (Do not modify) CDA8FD10BF5D2C2B4CB732E7AB84560C1A3EBF41CD94D9373F0147E5FF01E350
CREATE   VIEW [sqlmesh__hook].[hook__frame__northwind__employee_territories__3116720951] ([_pit_hook__employee__territory], [_hook__employee__territory], [_hook__employee__id], [_hook__territory__id], [territory_id], [territory_description], [region_id], [_get_northwindapiv_1_employees_employee_id], [_dlt_load_id], [_dlt_id], [_record__hash], [_record__loaded_at], [_record__updated_at], [_record__valid_from], [_record__valid_to], [_record__is_current], [_record__version]) AS WITH [cte__hooks] AS (SELECT CONCAT('northwind.employee.id|', CAST([scd_view__northwind__employee_territories].[_get_northwindapiv_1_employees_employee_id] AS VARCHAR(MAX))) AS [_hook__employee__id], CONCAT('northwind.territory.id|', CAST([scd_view__northwind__employee_territories].[territory_id] AS VARCHAR(MAX))) AS [_hook__territory__id], [scd_view__northwind__employee_territories].[territory_id] AS [territory_id], [scd_view__northwind__employee_territories].[territory_description] AS [territory_description], [scd_view__northwind__employee_territories].[region_id] AS [region_id], [scd_view__northwind__employee_territories].[_get_northwindapiv_1_employees_employee_id] AS [_get_northwindapiv_1_employees_employee_id], [scd_view__northwind__employee_territories].[_dlt_load_id] AS [_dlt_load_id], [scd_view__northwind__employee_territories].[_dlt_id] AS [_dlt_id], [scd_view__northwind__employee_territories].[_record__hash] AS [_record__hash], [scd_view__northwind__employee_territories].[_record__loaded_at] AS [_record__loaded_at], [scd_view__northwind__employee_territories].[_record__updated_at] AS [_record__updated_at], [scd_view__northwind__employee_territories].[_record__valid_from] AS [_record__valid_from], [scd_view__northwind__employee_territories].[_record__valid_to] AS [_record__valid_to], [scd_view__northwind__employee_territories].[_record__is_current] AS [_record__is_current], [scd_view__northwind__employee_territories].[_record__version] AS [_record__version] FROM [das].[sqlmesh__scd].[scd__scd_view__northwind__employee_territories__3311053740] AS [scd_view__northwind__employee_territories]), [cte__composite_hooks] AS (SELECT CONCAT([cte__hooks].[_hook__employee__id], '~', [cte__hooks].[_hook__territory__id]) AS [_hook__employee__territory], [cte__hooks].[_hook__employee__id] AS [_hook__employee__id], [cte__hooks].[_hook__territory__id] AS [_hook__territory__id], [cte__hooks].[territory_id] AS [territory_id], [cte__hooks].[territory_description] AS [territory_description], [cte__hooks].[region_id] AS [region_id], [cte__hooks].[_get_northwindapiv_1_employees_employee_id] AS [_get_northwindapiv_1_employees_employee_id], [cte__hooks].[_dlt_load_id] AS [_dlt_load_id], [cte__hooks].[_dlt_id] AS [_dlt_id], [cte__hooks].[_record__hash] AS [_record__hash], [cte__hooks].[_record__loaded_at] AS [_record__loaded_at], [cte__hooks].[_record__updated_at] AS [_record__updated_at], [cte__hooks].[_record__valid_from] AS [_record__valid_from], [cte__hooks].[_record__valid_to] AS [_record__valid_to], [cte__hooks].[_record__is_current] AS [_record__is_current], [cte__hooks].[_record__version] AS [_record__version] FROM [cte__hooks] AS [cte__hooks]), [cte__pit_hooks] AS (SELECT CONCAT('epoch.timestamp|', CAST([cte__composite_hooks].[_record__valid_from] AS VARCHAR(MAX)), '~', [cte__composite_hooks].[_hook__employee__territory]) AS [_pit_hook__employee__territory], [cte__composite_hooks].[_hook__employee__territory] AS [_hook__employee__territory], [cte__composite_hooks].[_hook__employee__id] AS [_hook__employee__id], [cte__composite_hooks].[_hook__territory__id] AS [_hook__territory__id], [cte__composite_hooks].[territory_id] AS [territory_id], [cte__composite_hooks].[territory_description] AS [territory_description], [cte__composite_hooks].[region_id] AS [region_id], [cte__composite_hooks].[_get_northwindapiv_1_employees_employee_id] AS [_get_northwindapiv_1_employees_employee_id], [cte__composite_hooks].[_dlt_load_id] AS [_dlt_load_id], [cte__composite_hooks].[_dlt_id] AS [_dlt_id], [cte__composite_hooks].[_record__hash] AS [_record__hash], [cte__composite_hooks].[_record__loaded_at] AS [_record__loaded_at], [cte__composite_hooks].[_record__updated_at] AS [_record__updated_at], [cte__composite_hooks].[_record__valid_from] AS [_record__valid_from], [cte__composite_hooks].[_record__valid_to] AS [_record__valid_to], [cte__composite_hooks].[_record__is_current] AS [_record__is_current], [cte__composite_hooks].[_record__version] AS [_record__version] FROM [cte__composite_hooks] AS [cte__composite_hooks]) SELECT [cte__pit_hooks].[_pit_hook__employee__territory] AS [_pit_hook__employee__territory], [cte__pit_hooks].[_hook__employee__territory] AS [_hook__employee__territory], [cte__pit_hooks].[_hook__employee__id] AS [_hook__employee__id], [cte__pit_hooks].[_hook__territory__id] AS [_hook__territory__id], [cte__pit_hooks].[territory_id] AS [territory_id], [cte__pit_hooks].[territory_description] AS [territory_description], [cte__pit_hooks].[region_id] AS [region_id], [cte__pit_hooks].[_get_northwindapiv_1_employees_employee_id] AS [_get_northwindapiv_1_employees_employee_id], [cte__pit_hooks].[_dlt_load_id] AS [_dlt_load_id], [cte__pit_hooks].[_dlt_id] AS [_dlt_id], [cte__pit_hooks].[_record__hash] AS [_record__hash], [cte__pit_hooks].[_record__loaded_at] AS [_record__loaded_at], [cte__pit_hooks].[_record__updated_at] AS [_record__updated_at], [cte__pit_hooks].[_record__valid_from] AS [_record__valid_from], [cte__pit_hooks].[_record__valid_to] AS [_record__valid_to], [cte__pit_hooks].[_record__is_current] AS [_record__is_current], [cte__pit_hooks].[_record__version] AS [_record__version] FROM [cte__pit_hooks] AS [cte__pit_hooks];