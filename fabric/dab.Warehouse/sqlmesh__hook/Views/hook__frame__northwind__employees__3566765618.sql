-- Auto Generated (Do not modify) 051EC7583BD230532AA3C65231F0AB9B1D8E8C5E7B3AE200B154C1750A01B3A0
CREATE   VIEW [sqlmesh__hook].[hook__frame__northwind__employees__3566765618] ([_pit_hook__employee__id], [hook__employee__id], [employee_id], [last_name], [first_name], [title], [title_of_courtesy], [birth_date], [hire_date], [address], [city], [region], [postal_code], [country], [home_phone], [extension], [photo], [notes], [reports_to], [photo_path], [_dlt_load_id], [_dlt_id], [_record__hash], [_record__loaded_at], [_record__updated_at], [_record__valid_from], [_record__valid_to], [_record__version], [_record__is_current]) AS WITH [cte__source] AS (SELECT [scd__northwind__employees].[employee_id] AS [employee_id], [scd__northwind__employees].[last_name] AS [last_name], [scd__northwind__employees].[first_name] AS [first_name], [scd__northwind__employees].[title] AS [title], [scd__northwind__employees].[title_of_courtesy] AS [title_of_courtesy], [scd__northwind__employees].[birth_date] AS [birth_date], [scd__northwind__employees].[hire_date] AS [hire_date], [scd__northwind__employees].[address] AS [address], [scd__northwind__employees].[city] AS [city], [scd__northwind__employees].[region] AS [region], [scd__northwind__employees].[postal_code] AS [postal_code], [scd__northwind__employees].[country] AS [country], [scd__northwind__employees].[home_phone] AS [home_phone], [scd__northwind__employees].[extension] AS [extension], [scd__northwind__employees].[photo] AS [photo], [scd__northwind__employees].[notes] AS [notes], [scd__northwind__employees].[reports_to] AS [reports_to], [scd__northwind__employees].[photo_path] AS [photo_path], [scd__northwind__employees].[_dlt_load_id] AS [_dlt_load_id], [scd__northwind__employees].[_dlt_id] AS [_dlt_id], [scd__northwind__employees].[_record__hash] AS [_record__hash], [scd__northwind__employees].[_record__loaded_at] AS [_record__loaded_at], [scd__northwind__employees].[_record__updated_at] AS [_record__updated_at], [scd__northwind__employees].[_record__valid_from] AS [_record__valid_from], [scd__northwind__employees].[_record__valid_to] AS [_record__valid_to], [scd__northwind__employees].[_record__version] AS [_record__version], [scd__northwind__employees].[_record__is_current] AS [_record__is_current] FROM [das].[sqlmesh__scd].[scd__scd__northwind__employees__4250458113] AS [scd__northwind__employees]), [cte__hooks] AS (SELECT CONCAT('northwind.employee.id|', CAST([cte__source].[employee_id] AS VARCHAR(MAX))) AS [hook__employee__id], [cte__source].[employee_id] AS [employee_id], [cte__source].[last_name] AS [last_name], [cte__source].[first_name] AS [first_name], [cte__source].[title] AS [title], [cte__source].[title_of_courtesy] AS [title_of_courtesy], [cte__source].[birth_date] AS [birth_date], [cte__source].[hire_date] AS [hire_date], [cte__source].[address] AS [address], [cte__source].[city] AS [city], [cte__source].[region] AS [region], [cte__source].[postal_code] AS [postal_code], [cte__source].[country] AS [country], [cte__source].[home_phone] AS [home_phone], [cte__source].[extension] AS [extension], [cte__source].[photo] AS [photo], [cte__source].[notes] AS [notes], [cte__source].[reports_to] AS [reports_to], [cte__source].[photo_path] AS [photo_path], [cte__source].[_dlt_load_id] AS [_dlt_load_id], [cte__source].[_dlt_id] AS [_dlt_id], [cte__source].[_record__hash] AS [_record__hash], [cte__source].[_record__loaded_at] AS [_record__loaded_at], [cte__source].[_record__updated_at] AS [_record__updated_at], [cte__source].[_record__valid_from] AS [_record__valid_from], [cte__source].[_record__valid_to] AS [_record__valid_to], [cte__source].[_record__version] AS [_record__version], [cte__source].[_record__is_current] AS [_record__is_current] FROM [cte__source] AS [cte__source]), [cte__composite_hooks] AS (SELECT [cte__hooks].[hook__employee__id] AS [hook__employee__id], [cte__hooks].[employee_id] AS [employee_id], [cte__hooks].[last_name] AS [last_name], [cte__hooks].[first_name] AS [first_name], [cte__hooks].[title] AS [title], [cte__hooks].[title_of_courtesy] AS [title_of_courtesy], [cte__hooks].[birth_date] AS [birth_date], [cte__hooks].[hire_date] AS [hire_date], [cte__hooks].[address] AS [address], [cte__hooks].[city] AS [city], [cte__hooks].[region] AS [region], [cte__hooks].[postal_code] AS [postal_code], [cte__hooks].[country] AS [country], [cte__hooks].[home_phone] AS [home_phone], [cte__hooks].[extension] AS [extension], [cte__hooks].[photo] AS [photo], [cte__hooks].[notes] AS [notes], [cte__hooks].[reports_to] AS [reports_to], [cte__hooks].[photo_path] AS [photo_path], [cte__hooks].[_dlt_load_id] AS [_dlt_load_id], [cte__hooks].[_dlt_id] AS [_dlt_id], [cte__hooks].[_record__hash] AS [_record__hash], [cte__hooks].[_record__loaded_at] AS [_record__loaded_at], [cte__hooks].[_record__updated_at] AS [_record__updated_at], [cte__hooks].[_record__valid_from] AS [_record__valid_from], [cte__hooks].[_record__valid_to] AS [_record__valid_to], [cte__hooks].[_record__version] AS [_record__version], [cte__hooks].[_record__is_current] AS [_record__is_current] FROM [cte__hooks] AS [cte__hooks]), [cte__primary_hooks] AS (SELECT CONCAT([cte__composite_hooks].[hook__employee__id], '~epoch__valid_from|', CAST([cte__composite_hooks].[_record__valid_from] AS VARCHAR(MAX))) AS [_pit_hook__employee__id], [cte__composite_hooks].[hook__employee__id] AS [hook__employee__id], [cte__composite_hooks].[employee_id] AS [employee_id], [cte__composite_hooks].[last_name] AS [last_name], [cte__composite_hooks].[first_name] AS [first_name], [cte__composite_hooks].[title] AS [title], [cte__composite_hooks].[title_of_courtesy] AS [title_of_courtesy], [cte__composite_hooks].[birth_date] AS [birth_date], [cte__composite_hooks].[hire_date] AS [hire_date], [cte__composite_hooks].[address] AS [address], [cte__composite_hooks].[city] AS [city], [cte__composite_hooks].[region] AS [region], [cte__composite_hooks].[postal_code] AS [postal_code], [cte__composite_hooks].[country] AS [country], [cte__composite_hooks].[home_phone] AS [home_phone], [cte__composite_hooks].[extension] AS [extension], [cte__composite_hooks].[photo] AS [photo], [cte__composite_hooks].[notes] AS [notes], [cte__composite_hooks].[reports_to] AS [reports_to], [cte__composite_hooks].[photo_path] AS [photo_path], [cte__composite_hooks].[_dlt_load_id] AS [_dlt_load_id], [cte__composite_hooks].[_dlt_id] AS [_dlt_id], [cte__composite_hooks].[_record__hash] AS [_record__hash], [cte__composite_hooks].[_record__loaded_at] AS [_record__loaded_at], [cte__composite_hooks].[_record__updated_at] AS [_record__updated_at], [cte__composite_hooks].[_record__valid_from] AS [_record__valid_from], [cte__composite_hooks].[_record__valid_to] AS [_record__valid_to], [cte__composite_hooks].[_record__version] AS [_record__version], [cte__composite_hooks].[_record__is_current] AS [_record__is_current] FROM [cte__composite_hooks] AS [cte__composite_hooks]) SELECT [cte__primary_hooks].[_pit_hook__employee__id] AS [_pit_hook__employee__id], [cte__primary_hooks].[hook__employee__id] AS [hook__employee__id], [cte__primary_hooks].[employee_id] AS [employee_id], [cte__primary_hooks].[last_name] AS [last_name], [cte__primary_hooks].[first_name] AS [first_name], [cte__primary_hooks].[title] AS [title], [cte__primary_hooks].[title_of_courtesy] AS [title_of_courtesy], [cte__primary_hooks].[birth_date] AS [birth_date], [cte__primary_hooks].[hire_date] AS [hire_date], [cte__primary_hooks].[address] AS [address], [cte__primary_hooks].[city] AS [city], [cte__primary_hooks].[region] AS [region], [cte__primary_hooks].[postal_code] AS [postal_code], [cte__primary_hooks].[country] AS [country], [cte__primary_hooks].[home_phone] AS [home_phone], [cte__primary_hooks].[extension] AS [extension], [cte__primary_hooks].[photo] AS [photo], [cte__primary_hooks].[notes] AS [notes], [cte__primary_hooks].[reports_to] AS [reports_to], [cte__primary_hooks].[photo_path] AS [photo_path], [cte__primary_hooks].[_dlt_load_id] AS [_dlt_load_id], [cte__primary_hooks].[_dlt_id] AS [_dlt_id], [cte__primary_hooks].[_record__hash] AS [_record__hash], [cte__primary_hooks].[_record__loaded_at] AS [_record__loaded_at], [cte__primary_hooks].[_record__updated_at] AS [_record__updated_at], [cte__primary_hooks].[_record__valid_from] AS [_record__valid_from], [cte__primary_hooks].[_record__valid_to] AS [_record__valid_to], [cte__primary_hooks].[_record__version] AS [_record__version], [cte__primary_hooks].[_record__is_current] AS [_record__is_current] FROM [cte__primary_hooks] AS [cte__primary_hooks];