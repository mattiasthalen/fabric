-- Auto Generated (Do not modify) 0DDC50321FE07F99E1F31396F78C0A39FEA5EB4D7D493DA66F5E2FC7869486F8
CREATE   VIEW [sqlmesh__hook].[hook__frame__northwind__territories__3009997829] ([_pit_hook__territory__id], [hook__territory__id], [hook__territory__name], [hook__region__id], [territory_id], [territory_description], [region_id], [_dlt_load_id], [_dlt_id], [_record__hash], [_record__loaded_at], [_record__updated_at], [_record__valid_from], [_record__valid_to], [_record__version], [_record__is_current]) AS WITH [cte__source] AS (SELECT [scd__northwind__territories].[territory_id] AS [territory_id], [scd__northwind__territories].[territory_description] AS [territory_description], [scd__northwind__territories].[region_id] AS [region_id], [scd__northwind__territories].[_dlt_load_id] AS [_dlt_load_id], [scd__northwind__territories].[_dlt_id] AS [_dlt_id], [scd__northwind__territories].[_record__hash] AS [_record__hash], [scd__northwind__territories].[_record__loaded_at] AS [_record__loaded_at], [scd__northwind__territories].[_record__updated_at] AS [_record__updated_at], [scd__northwind__territories].[_record__valid_from] AS [_record__valid_from], [scd__northwind__territories].[_record__valid_to] AS [_record__valid_to], [scd__northwind__territories].[_record__version] AS [_record__version], [scd__northwind__territories].[_record__is_current] AS [_record__is_current] FROM [das].[sqlmesh__scd].[scd__scd__northwind__territories__480820144] AS [scd__northwind__territories]), [cte__hooks] AS (SELECT CONCAT('northwind.territory.id|', CAST([cte__source].[territory_id] AS VARCHAR(MAX))) AS [hook__territory__id], CONCAT('northwind.territory.name|', CAST([cte__source].[territory_description] AS VARCHAR(MAX))) AS [hook__territory__name], CONCAT('northwind.region.id|', CAST([cte__source].[region_id] AS VARCHAR(MAX))) AS [hook__region__id], [cte__source].[territory_id] AS [territory_id], [cte__source].[territory_description] AS [territory_description], [cte__source].[region_id] AS [region_id], [cte__source].[_dlt_load_id] AS [_dlt_load_id], [cte__source].[_dlt_id] AS [_dlt_id], [cte__source].[_record__hash] AS [_record__hash], [cte__source].[_record__loaded_at] AS [_record__loaded_at], [cte__source].[_record__updated_at] AS [_record__updated_at], [cte__source].[_record__valid_from] AS [_record__valid_from], [cte__source].[_record__valid_to] AS [_record__valid_to], [cte__source].[_record__version] AS [_record__version], [cte__source].[_record__is_current] AS [_record__is_current] FROM [cte__source] AS [cte__source]), [cte__composite_hooks] AS (SELECT [cte__hooks].[hook__territory__id] AS [hook__territory__id], [cte__hooks].[hook__territory__name] AS [hook__territory__name], [cte__hooks].[hook__region__id] AS [hook__region__id], [cte__hooks].[territory_id] AS [territory_id], [cte__hooks].[territory_description] AS [territory_description], [cte__hooks].[region_id] AS [region_id], [cte__hooks].[_dlt_load_id] AS [_dlt_load_id], [cte__hooks].[_dlt_id] AS [_dlt_id], [cte__hooks].[_record__hash] AS [_record__hash], [cte__hooks].[_record__loaded_at] AS [_record__loaded_at], [cte__hooks].[_record__updated_at] AS [_record__updated_at], [cte__hooks].[_record__valid_from] AS [_record__valid_from], [cte__hooks].[_record__valid_to] AS [_record__valid_to], [cte__hooks].[_record__version] AS [_record__version], [cte__hooks].[_record__is_current] AS [_record__is_current] FROM [cte__hooks] AS [cte__hooks]), [cte__primary_hooks] AS (SELECT CONCAT([cte__composite_hooks].[hook__territory__id], '~epoch__valid_from|', CAST([cte__composite_hooks].[_record__valid_from] AS VARCHAR(MAX))) AS [_pit_hook__territory__id], [cte__composite_hooks].[hook__territory__id] AS [hook__territory__id], [cte__composite_hooks].[hook__territory__name] AS [hook__territory__name], [cte__composite_hooks].[hook__region__id] AS [hook__region__id], [cte__composite_hooks].[territory_id] AS [territory_id], [cte__composite_hooks].[territory_description] AS [territory_description], [cte__composite_hooks].[region_id] AS [region_id], [cte__composite_hooks].[_dlt_load_id] AS [_dlt_load_id], [cte__composite_hooks].[_dlt_id] AS [_dlt_id], [cte__composite_hooks].[_record__hash] AS [_record__hash], [cte__composite_hooks].[_record__loaded_at] AS [_record__loaded_at], [cte__composite_hooks].[_record__updated_at] AS [_record__updated_at], [cte__composite_hooks].[_record__valid_from] AS [_record__valid_from], [cte__composite_hooks].[_record__valid_to] AS [_record__valid_to], [cte__composite_hooks].[_record__version] AS [_record__version], [cte__composite_hooks].[_record__is_current] AS [_record__is_current] FROM [cte__composite_hooks] AS [cte__composite_hooks]) SELECT [cte__primary_hooks].[_pit_hook__territory__id] AS [_pit_hook__territory__id], [cte__primary_hooks].[hook__territory__id] AS [hook__territory__id], [cte__primary_hooks].[hook__territory__name] AS [hook__territory__name], [cte__primary_hooks].[hook__region__id] AS [hook__region__id], [cte__primary_hooks].[territory_id] AS [territory_id], [cte__primary_hooks].[territory_description] AS [territory_description], [cte__primary_hooks].[region_id] AS [region_id], [cte__primary_hooks].[_dlt_load_id] AS [_dlt_load_id], [cte__primary_hooks].[_dlt_id] AS [_dlt_id], [cte__primary_hooks].[_record__hash] AS [_record__hash], [cte__primary_hooks].[_record__loaded_at] AS [_record__loaded_at], [cte__primary_hooks].[_record__updated_at] AS [_record__updated_at], [cte__primary_hooks].[_record__valid_from] AS [_record__valid_from], [cte__primary_hooks].[_record__valid_to] AS [_record__valid_to], [cte__primary_hooks].[_record__version] AS [_record__version], [cte__primary_hooks].[_record__is_current] AS [_record__is_current] FROM [cte__primary_hooks] AS [cte__primary_hooks];