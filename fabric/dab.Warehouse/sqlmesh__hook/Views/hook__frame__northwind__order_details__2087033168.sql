-- Auto Generated (Do not modify) B1944781B556B06CEDF6CEF0E87189CF5E192DD35242F4EA8113CF7EF80623AE
CREATE   VIEW [sqlmesh__hook].[hook__frame__northwind__order_details__2087033168] ([_pit_hook__order__product], [_hook__order__product], [_hook__order__id], [_hook__product__id], [order_id], [product_id], [unit_price], [quantity], [discount], [_dlt_load_id], [_dlt_id], [discount__v_double], [_record__hash], [_record__loaded_at], [_record__updated_at], [_record__valid_from], [_record__valid_to], [_record__version], [_record__is_current]) AS WITH [cte__hooks] AS (SELECT CONCAT('northwind.order.id|', CAST([scd__northwind__order_details].[order_id] AS VARCHAR(MAX))) AS [_hook__order__id], CONCAT('northwind.product.id|', CAST([scd__northwind__order_details].[product_id] AS VARCHAR(MAX))) AS [_hook__product__id], [scd__northwind__order_details].[order_id] AS [order_id], [scd__northwind__order_details].[product_id] AS [product_id], [scd__northwind__order_details].[unit_price] AS [unit_price], [scd__northwind__order_details].[quantity] AS [quantity], [scd__northwind__order_details].[discount] AS [discount], [scd__northwind__order_details].[_dlt_load_id] AS [_dlt_load_id], [scd__northwind__order_details].[_dlt_id] AS [_dlt_id], [scd__northwind__order_details].[discount__v_double] AS [discount__v_double], [scd__northwind__order_details].[_record__hash] AS [_record__hash], [scd__northwind__order_details].[_record__loaded_at] AS [_record__loaded_at], [scd__northwind__order_details].[_record__updated_at] AS [_record__updated_at], [scd__northwind__order_details].[_record__valid_from] AS [_record__valid_from], [scd__northwind__order_details].[_record__valid_to] AS [_record__valid_to], [scd__northwind__order_details].[_record__version] AS [_record__version], [scd__northwind__order_details].[_record__is_current] AS [_record__is_current] FROM [das].[sqlmesh__scd].[scd__scd__northwind__order_details__699993766] AS [scd__northwind__order_details]), [cte__composite_hooks] AS (SELECT CONCAT([cte__hooks].[_hook__order__id], '~', [cte__hooks].[_hook__product__id]) AS [_hook__order__product], [cte__hooks].[_hook__order__id] AS [_hook__order__id], [cte__hooks].[_hook__product__id] AS [_hook__product__id], [cte__hooks].[order_id] AS [order_id], [cte__hooks].[product_id] AS [product_id], [cte__hooks].[unit_price] AS [unit_price], [cte__hooks].[quantity] AS [quantity], [cte__hooks].[discount] AS [discount], [cte__hooks].[_dlt_load_id] AS [_dlt_load_id], [cte__hooks].[_dlt_id] AS [_dlt_id], [cte__hooks].[discount__v_double] AS [discount__v_double], [cte__hooks].[_record__hash] AS [_record__hash], [cte__hooks].[_record__loaded_at] AS [_record__loaded_at], [cte__hooks].[_record__updated_at] AS [_record__updated_at], [cte__hooks].[_record__valid_from] AS [_record__valid_from], [cte__hooks].[_record__valid_to] AS [_record__valid_to], [cte__hooks].[_record__version] AS [_record__version], [cte__hooks].[_record__is_current] AS [_record__is_current] FROM [cte__hooks] AS [cte__hooks]), [cte__pit_hooks] AS (SELECT CONCAT('epoch.timestamp|', CAST([cte__composite_hooks].[_record__valid_from] AS VARCHAR(MAX)), '~', [cte__composite_hooks].[_hook__order__product]) AS [_pit_hook__order__product], [cte__composite_hooks].[_hook__order__product] AS [_hook__order__product], [cte__composite_hooks].[_hook__order__id] AS [_hook__order__id], [cte__composite_hooks].[_hook__product__id] AS [_hook__product__id], [cte__composite_hooks].[order_id] AS [order_id], [cte__composite_hooks].[product_id] AS [product_id], [cte__composite_hooks].[unit_price] AS [unit_price], [cte__composite_hooks].[quantity] AS [quantity], [cte__composite_hooks].[discount] AS [discount], [cte__composite_hooks].[_dlt_load_id] AS [_dlt_load_id], [cte__composite_hooks].[_dlt_id] AS [_dlt_id], [cte__composite_hooks].[discount__v_double] AS [discount__v_double], [cte__composite_hooks].[_record__hash] AS [_record__hash], [cte__composite_hooks].[_record__loaded_at] AS [_record__loaded_at], [cte__composite_hooks].[_record__updated_at] AS [_record__updated_at], [cte__composite_hooks].[_record__valid_from] AS [_record__valid_from], [cte__composite_hooks].[_record__valid_to] AS [_record__valid_to], [cte__composite_hooks].[_record__version] AS [_record__version], [cte__composite_hooks].[_record__is_current] AS [_record__is_current] FROM [cte__composite_hooks] AS [cte__composite_hooks]) SELECT [cte__pit_hooks].[_pit_hook__order__product] AS [_pit_hook__order__product], [cte__pit_hooks].[_hook__order__product] AS [_hook__order__product], [cte__pit_hooks].[_hook__order__id] AS [_hook__order__id], [cte__pit_hooks].[_hook__product__id] AS [_hook__product__id], [cte__pit_hooks].[order_id] AS [order_id], [cte__pit_hooks].[product_id] AS [product_id], [cte__pit_hooks].[unit_price] AS [unit_price], [cte__pit_hooks].[quantity] AS [quantity], [cte__pit_hooks].[discount] AS [discount], [cte__pit_hooks].[_dlt_load_id] AS [_dlt_load_id], [cte__pit_hooks].[_dlt_id] AS [_dlt_id], [cte__pit_hooks].[discount__v_double] AS [discount__v_double], [cte__pit_hooks].[_record__hash] AS [_record__hash], [cte__pit_hooks].[_record__loaded_at] AS [_record__loaded_at], [cte__pit_hooks].[_record__updated_at] AS [_record__updated_at], [cte__pit_hooks].[_record__valid_from] AS [_record__valid_from], [cte__pit_hooks].[_record__valid_to] AS [_record__valid_to], [cte__pit_hooks].[_record__version] AS [_record__version], [cte__pit_hooks].[_record__is_current] AS [_record__is_current] FROM [cte__pit_hooks] AS [cte__pit_hooks];