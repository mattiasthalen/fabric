-- Auto Generated (Do not modify) 2416C37BAEB5E5113FADC0B6E9D1168BA0B5FE49B63CDD13FF38EB0743B4FA61
CREATE   VIEW [sqlmesh__hook].[hook__frame__northwind__category_details__1183087154__dev] ([_pit_hook__category__id], [_hook__category__id], [category_id], [category_name], [description], [picture], [product_names], [_dlt_load_id], [_dlt_id], [_record__hash], [_record__loaded_at], [_record__updated_at], [_record__valid_from], [_record__valid_to], [_record__is_current], [_record__version]) AS WITH [cte__record_validity] AS (SELECT [scd__northwind__category_details].[category_id] AS [category_id], [scd__northwind__category_details].[category_name] AS [category_name], [scd__northwind__category_details].[description] AS [description], [scd__northwind__category_details].[picture] AS [picture], [scd__northwind__category_details].[product_names] AS [product_names], [scd__northwind__category_details].[_dlt_load_id] AS [_dlt_load_id], [scd__northwind__category_details].[_dlt_id] AS [_dlt_id], [scd__northwind__category_details].[_record__hash] AS [_record__hash], [scd__northwind__category_details].[_record__loaded_at] AS [_record__loaded_at], GREATEST([scd__northwind__category_details].[_record__valid_to], [scd__northwind__category_details].[_record__loaded_at]) AS [_record__updated_at], [scd__northwind__category_details].[_record__valid_from] AS [_record__valid_from], COALESCE([scd__northwind__category_details].[_record__valid_to], CAST('9999-12-31 23:59:59' AS DATETIME2(6))) AS [_record__valid_to], CASE WHEN [scd__northwind__category_details].[_record__valid_to] IS NULL THEN 1 ELSE 0 END AS [_record__is_current], ROW_NUMBER() OVER (PARTITION BY [scd__northwind__category_details].[category_id] ORDER BY CASE WHEN [scd__northwind__category_details].[_record__valid_from] IS NULL THEN 1 ELSE 0 END, [scd__northwind__category_details].[_record__valid_from] ASC) AS [_record__version] FROM [das].[sqlmesh__scd].[scd__scd__northwind__category_details__1880376064__dev] AS [scd__northwind__category_details]), [cte__hooks] AS (SELECT CONCAT('northwind.category_detail.id|', CAST([cte__record_validity].[category_id] AS VARCHAR(MAX))) AS [_hook__category__id], [cte__record_validity].[category_id] AS [category_id], [cte__record_validity].[category_name] AS [category_name], [cte__record_validity].[description] AS [description], [cte__record_validity].[picture] AS [picture], [cte__record_validity].[product_names] AS [product_names], [cte__record_validity].[_dlt_load_id] AS [_dlt_load_id], [cte__record_validity].[_dlt_id] AS [_dlt_id], [cte__record_validity].[_record__hash] AS [_record__hash], [cte__record_validity].[_record__loaded_at] AS [_record__loaded_at], [cte__record_validity].[_record__updated_at] AS [_record__updated_at], [cte__record_validity].[_record__valid_from] AS [_record__valid_from], [cte__record_validity].[_record__valid_to] AS [_record__valid_to], [cte__record_validity].[_record__is_current] AS [_record__is_current], [cte__record_validity].[_record__version] AS [_record__version] FROM [cte__record_validity] AS [cte__record_validity]), [cte__pit_hooks] AS (SELECT CONCAT('epoch.timestamp|', CAST([cte__hooks].[_record__valid_from] AS VARCHAR(MAX)), '~', [cte__hooks].[_hook__category__id]) AS [_pit_hook__category__id], [cte__hooks].[_hook__category__id] AS [_hook__category__id], [cte__hooks].[category_id] AS [category_id], [cte__hooks].[category_name] AS [category_name], [cte__hooks].[description] AS [description], [cte__hooks].[picture] AS [picture], [cte__hooks].[product_names] AS [product_names], [cte__hooks].[_dlt_load_id] AS [_dlt_load_id], [cte__hooks].[_dlt_id] AS [_dlt_id], [cte__hooks].[_record__hash] AS [_record__hash], [cte__hooks].[_record__loaded_at] AS [_record__loaded_at], [cte__hooks].[_record__updated_at] AS [_record__updated_at], [cte__hooks].[_record__valid_from] AS [_record__valid_from], [cte__hooks].[_record__valid_to] AS [_record__valid_to], [cte__hooks].[_record__is_current] AS [_record__is_current], [cte__hooks].[_record__version] AS [_record__version] FROM [cte__hooks] AS [cte__hooks]) SELECT [cte__pit_hooks].[_pit_hook__category__id] AS [_pit_hook__category__id], [cte__pit_hooks].[_hook__category__id] AS [_hook__category__id], [cte__pit_hooks].[category_id] AS [category_id], [cte__pit_hooks].[category_name] AS [category_name], [cte__pit_hooks].[description] AS [description], [cte__pit_hooks].[picture] AS [picture], [cte__pit_hooks].[product_names] AS [product_names], [cte__pit_hooks].[_dlt_load_id] AS [_dlt_load_id], [cte__pit_hooks].[_dlt_id] AS [_dlt_id], [cte__pit_hooks].[_record__hash] AS [_record__hash], [cte__pit_hooks].[_record__loaded_at] AS [_record__loaded_at], [cte__pit_hooks].[_record__updated_at] AS [_record__updated_at], [cte__pit_hooks].[_record__valid_from] AS [_record__valid_from], [cte__pit_hooks].[_record__valid_to] AS [_record__valid_to], [cte__pit_hooks].[_record__is_current] AS [_record__is_current], [cte__pit_hooks].[_record__version] AS [_record__version] FROM [cte__pit_hooks] AS [cte__pit_hooks];